{"Version":{"Major":1,"Minor":2,"Release":2},"Storia":["Versione 1.3.2    30 Settembre 2020","                  - NEW: Aggiunto campo nascosto a tabella istituti","                  - NEW: Aggiunta store procedure che unisce e nasconde gli istituti","                  - NEW: Aggiunte funzioni di calcolo per la disponibilita dei titoli","Versione 1.2.2    15 Settembre 2020","                  - FIX: Introdotta data attuale log movimenti","                  - NEW: Inserito campo EMAIL_ARCHIVIO nella tabella configurazione_ditta","Versione 1.1.1    14 Settembre 2020","                  - FIX: Errore trigger inserimento spedizione","Versione 1.1.0    11 Settembre 2020","                  - NEW: Aggiunta la gestione delle disponibilit\u00e0","                         Eliminati gli errore di terza forma normale","Versione 1.0.0    07 Settembre 2020","                  - Prima versione"],"ListaTabelle":[{"Nome":"configurazione_ditta","Campi":[{"Nome":"INDIRIZZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EMAIL","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"SITO_WEB","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TELEFONO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EMAIL_ARCHIVIO","IsNullable":true,"DataType":"varchar(50)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":null,"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"debug_sql","Campi":[{"Nome":"TESTO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":null,"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"materie_insegnamento","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"DESCRIZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"docenti","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"RAGIONE_SOCIALE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"MATERIA_1","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"MATERIA_2","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"MATERIA_3","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"LYBRO_KEY","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"INDIRIZZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"COMUNE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CAP","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROVINCIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PIATTAFORMA","IsNullable":true,"DataType":"char(1)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TEL_PRIMO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TEL_SECONDO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TEL_TERZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EMAIL","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"NOTE","IsNullable":true,"DataType":"text","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_DOCENTI_MATERIE_INSEGAMENTO_1","Campo":"MATERIA_1","RefTable":"materie_insegnamento","RefField":"CHIAVE"},{"Nome":"FK_DOCENTI_MATERIE_INSEGAMENTO_2","Campo":"MATERIA_2","RefTable":"materie_insegnamento","RefField":"CHIAVE"},{"Nome":"FK_DOCENTI_MATERIE_INSEGAMENTO_3","Campo":"MATERIA_3","RefTable":"materie_insegnamento","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"province","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"NOME","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"province_all","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"NOME","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"''","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"tipologie_escluse_istituto","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"DESCRIZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"''","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"tipologie_istituto","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"DESCRIZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"titoli","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"CODICE_ISBN","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"SOTTOTITOLO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"MATERIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"AUTORI","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EDITORE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"VOLUME","IsNullable":true,"DataType":"tinyint(4)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"POS_MAGAZZINO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA_MGZN","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"QUANTITA_MGZN_VOL","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"PREZZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_TITOLI_MATERIE_INSEGNAMENTO","Campo":"MATERIA","RefTable":"materie_insegnamento","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[{"Nome":"titoli_after_insert","Event":"INSERT","Body":"BEGIN\r\n  IF NEW.QUANTITA_MGZN <> 0 THEN\r\n    INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.CHIAVE,NEW.QUANTITA_MGZN,'Aggiunto nuovo titolo al magazzino');\r\n  END IF;\r\n  \r\n  IF NEW.QUANTITA_MGZN_VOL <> 0 THEN\r\n    INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.CHIAVE,NEW.QUANTITA_MGZN_VOL,'Aggiunto nuovo titolo al magazzino');\r\n  END IF;\r\n\r\nEND","Timing":"AFTER"},{"Nome":"titoli_after_delete","Event":"DELETE","Body":"BEGIN\r\n  \r\n  DELETE FROM movimenti_magazzino \r\n   WHERE TITOLO = OLD.CHIAVE;\r\n  DELETE FROM movimenti_magazzino_volante \r\n   WHERE TITOLO = OLD.CHIAVE;\r\n\r\nEND","Timing":"BEFORE"}]},{"Nome":"ordini_ingresso","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"DATA","IsNullable":true,"DataType":"date","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_ORDINI_INGRESSO_TITOLI","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[{"Nome":"ordini_ingresso_after_insert","Event":"INSERT","Body":"BEGIN\r\n  \r\n  UPDATE titoli SET QUANTITA_MGZN=(QUANTITA_MGZN + NEW.QUANTITA) \r\n   WHERE CHIAVE = NEW.TITOLO;\r\n  INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,NEW.QUANTITA,'Nuovo ingresso titolo');\r\n\r\nEND","Timing":"AFTER"},{"Nome":"ordini_ingresso_after_update","Event":"UPDATE","Body":"BEGIN\r\n   \r\n\tIF NEW.TITOLO <> OLD.TITOLO THEN\r\n      UPDATE titoli SET QUANTITA_MGZN = (QUANTITA_MGZN - OLD.QUANTITA) \r\n\t  \t WHERE CHIAVE = OLD.TITOLO;\r\n      UPDATE titoli SET QUANTITA_MGZN = (QUANTITA_MGZN + NEW.QUANTITA) \r\n\t\t WHERE CHIAVE = NEW.TITOLO;\r\n      INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,NEW.QUANTITA,'Nuovo ingresso titolo');\r\n      INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,(-1)*OLD.QUANTITA,'Modifica ingresso titolo');\r\n      \r\n   ELSE\r\n\t   IF NEW.QUANTITA <> OLD.QUANTITA THEN  \r\n         UPDATE titoli SET QUANTITA_MGZN = (QUANTITA_MGZN + (NEW.QUANTITA - OLD.QUANTITA)) WHERE CHIAVE = OLD.TITOLO;\r\n         INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,NEW.QUANTITA,'Modifica ingresso titolo');\r\n      END IF;  \r\n   END IF;\r\n\r\nEND","Timing":"AFTER"},{"Nome":"ordini_ingresso_after_delete","Event":"DELETE","Body":"BEGIN\r\n\r\n  UPDATE titoli SET QUANTITA_MGZN=(QUANTITA_MGZN - OLD.QUANTITA) \r\n   WHERE CHIAVE = OLD.TITOLO;\r\n  INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,(-1)*OLD.QUANTITA,'Eliminazione ingresso titolo');\r\n\r\nEND","Timing":"AFTER"}]},{"Nome":"movimenti_magazzino_volante","Campi":[{"Nome":"DATA","IsNullable":true,"DataType":"date","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"DESCRIZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":null,"ForeignKeys":[{"Nome":"FK_MOVIMENTI_MAG_VOL_TITOLO","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"movimenti_magazzino","Campi":[{"Nome":"DATA","IsNullable":true,"DataType":"date","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"DESCRIZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":null,"ForeignKeys":[{"Nome":"FK_MOVIMENTI_MAG_TITOLO","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"utenti","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"USERNAME","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"RAGIONE_SOCIALE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PASSWORD","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EMAIL","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"ROLE","IsNullable":false,"DataType":"smallint(1)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"ELIMINATO","IsNullable":true,"DataType":"bit(1)","AutoIncrement":false,"Commento":"","DefaultValue":"b'0'","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"magazzino_volante","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"DATA","IsNullable":true,"DataType":"date","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROMOTORE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK__UTENTI","Campo":"PROMOTORE","RefTable":"utenti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"dettaglio_magazzino_volante","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"MOVIMENTO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK__MAGAZZINO_VOLANTE","Campo":"MOVIMENTO","RefTable":"magazzino_volante","RefField":"CHIAVE"},{"Nome":"FK__TITOLI","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[{"Nome":"dettaglio_magazzino_volante_after_insert","Event":"INSERT","Body":"BEGIN\r\n\r\n  UPDATE titoli \r\n     SET QUANTITA_MGZN = QUANTITA_MGZN - NEW.QUANTITA,\r\n\t      QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + NEW.QUANTITA\r\n   WHERE CHIAVE = NEW.TITOLO;\r\n  INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,NEW.QUANTITA,'Titolo spostato nel magazzino volante');\r\n  INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Titolo spostato nel magazzino volante');\r\n\r\nEND","Timing":"AFTER"},{"Nome":"dettaglio_magazzino_volante_after_update","Event":"UPDATE","Body":"BEGIN\r\n  IF NEW.TITOLO = OLD.TITOLO THEN\r\n    IF NEW.QUANTITA <> OLD.QUANTITA THEN\r\n\t     UPDATE titoli \r\n\t\t     SET QUANTITA_MGZN = QUANTITA_MGZN  - (NEW.QUANTITA - OLD.QUANTITA) ,\r\n\t\t         QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + (NEW.QUANTITA - OLD.QUANTITA)\r\n\t\t  WHERE CHIAVE = NEW.TITOLO;\r\n\t\t  INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,OLD.QUANTITA - NEW.QUANTITA,'Modifica dettaglio volante');\r\n\t\t  INSERT INTO movimenti_magazzino_volante\t(DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,NEW.QUANTITA - OLD.QUANTITA,'Modifica dettaglio volante');\r\n\tEND IF;\r\n  ELSE\r\n    UPDATE titoli\r\n       SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA,\r\n           QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL - OLD.QUANTITA\r\n    WHERE CHIAVE = OLD.TITOLO;\r\n\t INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio volante');\r\n\t INSERT INTO movimenti_magazzino_volante\t(DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,(-1)*OLD.QUANTITA,'Modifica dettaglio volante');\r\n    UPDATE titoli\r\n       SET QUANTITA_MGZN = QUANTITA_MGZN - NEW.QUANTITA,\r\n           QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + NEW.QUANTITA\r\n    WHERE CHIAVE = NEW.TITOLO;\r\n\t INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Modifica dettaglio volante');\r\n\t INSERT INTO movimenti_magazzino_volante\t(DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,NEW.QUANTITA,'Modifica dettaglio volante');\r\n  END IF;\r\nEND","Timing":"AFTER"},{"Nome":"dettaglio_magazzino_volante_after_delete","Event":"DELETE","Body":"BEGIN\r\n\r\n  UPDATE titoli\r\n     SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA,\r\n\t      QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL - OLD.QUANTITA \r\n\tWHERE CHIAVE = OLD.TITOLO;\r\n  INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),OLD.TITOLO,(-1)*OLD.QUANTITA,'Eliminato movimento titolo su magazzino volante');\r\n  INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),OLD.TITOLO,OLD.QUANTITA,'Riaggiunta quantita titolo da magazzino volante');\r\n  \r\nEND","Timing":"AFTER"}]},{"Nome":"istituti","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"CODICE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"NOME","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"INDIRIZZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROVINCIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"COMUNE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CAP","IsNullable":true,"DataType":"varchar(5)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"EMAIL","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PEC","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"SITO_WEB","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"SEDE","IsNullable":true,"DataType":"bit(1)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"REFERENTE_1","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TELEFONO_1","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"REFERENTE_2","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TELEFONO_2","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"REFERENTE_3","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TELEFONO_3","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROMOTORE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TIPOLOGIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PRESIDE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"VICEPRESIDE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"DIR_AMMNSTR","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"NASCOSTO","IsNullable":true,"DataType":"bit(1)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_ISTITUTI_PROVINCE","Campo":"PROVINCIA","RefTable":"province","RefField":"CHIAVE"},{"Nome":"FK_ISTITUTI_TIPOLOGIE_ISTITUTO","Campo":"TIPOLOGIA","RefTable":"tipologie_istituto","RefField":"CHIAVE"},{"Nome":"FK_ISTITUTI_UTENTI","Campo":"PROMOTORE","RefTable":"utenti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"spedizioni","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"PRESSO","IsNullable":false,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"''","SQLAfterAddedColumn":null},{"Nome":"DOCENTE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"INDIRIZZO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"COMUNE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CAP","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROVINCIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"PROMOTORE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"DATA","IsNullable":true,"DataType":"date","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"ISTITUTO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_SPEDIZIONI_DOCENTI","Campo":"DOCENTE","RefTable":"docenti","RefField":"CHIAVE"},{"Nome":"FK_SPEDIZIONI_ISTITUTI","Campo":"ISTITUTO","RefTable":"istituti","RefField":"CHIAVE"},{"Nome":"FK_SPEDIZIONI_PROVINCE_ALL","Campo":"PROVINCIA","RefTable":"province_all","RefField":"CHIAVE"},{"Nome":"FK_SPEDIZIONI_UTENTI","Campo":"PROMOTORE","RefTable":"utenti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"dettaglio_spedizioni","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"SPEDIZIONE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"QUANTITA","IsNullable":true,"DataType":"tinyint(4)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"STATO","IsNullable":true,"DataType":"char(50)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CONS_A_MANO","IsNullable":true,"DataType":"bit(1)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_DETTAGLIO_SPEDIZIONI","Campo":"SPEDIZIONE","RefTable":"spedizioni","RefField":"CHIAVE"},{"Nome":"FK_DETTAGLIO_SPEDIZIONI_TITOLO","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[{"Nome":"dettaglio_spedizioni_after_insert","Event":"INSERT","Body":"BEGIN\r\n  \r\n  IF NEW.STATO = 'C' THEN\r\n    SET NEW.CONS_A_MANO := 1;\r\n UPDATE titoli \r\n\t SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL - NEW.QUANTITA\r\n  WHERE CHIAVE = NEW.TITOLO;\r\n INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Titolo consegnato a mano, quantita titolo rimossa dal magazzino volante');\r\n   ELSE  \r\n    SET NEW.CONS_A_MANO := 0;\r\n  END IF;\r\n\r\nEND","Timing":"BEFORE"},{"Nome":"dettaglio_spedizioni_after_update","Event":"UPDATE","Body":"BEGIN\r\n DECLARE ConsegnatoAMano BIT;\r\n SELECT CONS_A_MANO\r\n   FROM dettaglio_spedizioni\r\n  WHERE CHIAVE = OLD.CHIAVE\r\n   INTO ConsegnatoAMano;\r\n\r\n IF NEW.TITOLO = OLD.TITOLO THEN\r\n    IF OLD.STATO <> NEW.STATO THEN\r\n       IF OLD.STATO = 'C' THEN\r\n          IF ConsegnatoAMano = 1 THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n          ELSE\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n          END IF;\r\n       END IF;\r\n       IF NEW.STATO = 'C' THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN - NEW.QUANTITA\r\n            WHERE CHIAVE = NEW.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n       END IF;\r\n    ELSE\r\n      IF (NEW.QUANTITA <> OLD.QUANTITA) AND (NEW.STATO = 'C') THEN\r\n         IF ConsegnatoAMano = 1 THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + (OLD.QUANTITA - NEW.QUANTITA)\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA - NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n         ELSE\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN + (OLD.QUANTITA - NEW.QUANTITA)\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA - NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n\t\t\tEND IF;\r\n      END IF;\r\n\t END IF;\r\n ELSE\r\n    IF OLD.STATO <> NEW.STATO THEN\r\n       IF OLD.STATO = 'C' THEN\r\n          IF ConsegnatoAMano = 1 THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n          ELSE\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n          END IF;\r\n       END IF;\r\n       IF NEW.STATO = 'C' THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN - NEW.QUANTITA\r\n            WHERE CHIAVE = NEW.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n       END IF;\r\n    ELSE\r\n      IF NEW.STATO = 'C' THEN\r\n         IF ConsegnatoAMano = 1 THEN\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL - NEW.QUANTITA\r\n            WHERE CHIAVE = NEW.TITOLO;\r\n           INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n         ELSE\r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA\r\n            WHERE CHIAVE = OLD.TITOLO;\r\n           INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),OLD.TITOLO,OLD.QUANTITA,'Modifica dettaglio spedizione');            \r\n           UPDATE titoli\r\n              SET QUANTITA_MGZN = QUANTITA_MGZN - NEW.QUANTITA\r\n            WHERE CHIAVE = NEW.TITOLO;\r\n           INSERT INTO movimenti_magazzino(DATA,TITOLO,QUANTITA,DESCRIZIONE)VALUES(NOW(),NEW.TITOLO,(-1)*NEW.QUANTITA,'Modifica dettaglio spedizione');            \r\n\t\t\tEND IF;\r\n      END IF;\r\n\t END IF;\r\n END IF;\r\nEND","Timing":"AFTER"},{"Nome":"dettaglio_spedizioni_after_delete","Event":"DELETE","Body":"BEGIN\r\n  \r\n  IF OLD.STATO = 'C' THEN\r\n     IF OLD.CONS_A_MANO = 1 THEN\r\n        UPDATE titoli \r\n\t\t     SET QUANTITA_MGZN_VOL = QUANTITA_MGZN_VOL + QUANTITA_MGZN_VOL \r\n\t\t\tWHERE CHIAVE = OLD.TITOLO;\r\n        INSERT INTO movimenti_magazzino_volante (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),OLD.TITOLO,OLD.QUANTITA,'Dettaglio spedizione eliminato, quantita titolo riaggiunta al magazzino volante');\r\n     ELSE\r\n        UPDATE titoli SET QUANTITA_MGZN = QUANTITA_MGZN + OLD.QUANTITA WHERE CHIAVE = OLD.TITOLO;\r\n        INSERT INTO movimenti_magazzino (DATA,TITOLO,QUANTITA,DESCRIZIONE) VALUES (NOW(),OLD.TITOLO,OLD.QUANTITA,'Dettaglio spedizione eliminato, quantita titolo riaggiunta al magazzino');\r\n     END IF;\r\n  END IF;\r\n\r\nEND","Timing":"AFTER"}]},{"Nome":"istituti_x_titoli","Campi":[{"Nome":"TITOLO","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"ISTITUTO","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["TITOLO","ISTITUTO"]},"ForeignKeys":[{"Nome":"FK_ISTITUTI","Campo":"ISTITUTO","RefTable":"istituti","RefField":"CHIAVE"},{"Nome":"FK_TITOLI","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"istituti_x_docenti","Campi":[{"Nome":"DOCENTE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"ISTITUTO","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["DOCENTE","ISTITUTO"]},"ForeignKeys":[{"Nome":"FK__DOCENTI","Campo":"DOCENTE","RefTable":"docenti","RefField":"CHIAVE"},{"Nome":"FK__ISTITUTI","Campo":"ISTITUTO","RefTable":"istituti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"classi","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"ANNO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"SEZIONE","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"ISTITUTO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_CLASSI_ISTITUTO","Campo":"ISTITUTO","RefTable":"istituti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"adozioni_titolo","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"TITOLO","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CLASSE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_ADOZIONI_TITOLO_CLASSI","Campo":"CLASSE","RefTable":"classi","RefField":"CHIAVE"},{"Nome":"FK_ADOZIONI_TITOLO_TITOLI","Campo":"TITOLO","RefTable":"titoli","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"insegnamenti_docente","Campi":[{"Nome":"CHIAVE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"MATERIA","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"CLASSE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"GIORNO","IsNullable":true,"DataType":"tinyint(1)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"ORARIO","IsNullable":true,"DataType":"varchar(255)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null},{"Nome":"DOCENTE","IsNullable":true,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"NULL","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["CHIAVE"]},"ForeignKeys":[{"Nome":"FK_INS_DOCENTI_CLASSE","Campo":"CLASSE","RefTable":"classi","RefField":"CHIAVE"},{"Nome":"FK_INS_DOCENTI_MATERIA","Campo":"MATERIA","RefTable":"materie_insegnamento","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]},{"Nome":"docenti_disponibilita","Campi":[{"Nome":"DOCENTE","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":null,"SQLAfterAddedColumn":null},{"Nome":"ISTITUTO","IsNullable":false,"DataType":"int(11)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"GIORNO","IsNullable":false,"DataType":"tinyint(4)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"POSIZIONE","IsNullable":false,"DataType":"tinyint(4)","AutoIncrement":false,"Commento":"","DefaultValue":"0","SQLAfterAddedColumn":null},{"Nome":"DA","IsNullable":true,"DataType":"time","AutoIncrement":false,"Commento":"","DefaultValue":"'00:00:00'","SQLAfterAddedColumn":null},{"Nome":"A","IsNullable":true,"DataType":"time","AutoIncrement":false,"Commento":"","DefaultValue":"'00:00:00'","SQLAfterAddedColumn":null}],"PrimaryKey":{"Campi":["DOCENTE","ISTITUTO","GIORNO","POSIZIONE"]},"ForeignKeys":[{"Nome":"FK_DOCENTI_DISBONBILITA_DOCENTI","Campo":"DOCENTE","RefTable":"docenti","RefField":"CHIAVE"},{"Nome":"FK_DOCENTI_DISPONIBILITA_ISTITUTI","Campo":"ISTITUTO","RefTable":"istituti","RefField":"CHIAVE"}],"UniqueKeys":[],"Indexes":[],"Triggers":[]}],"ListaGeneratori":[{"Nome":"gen_key","CampoGeneratore":"CHIAVE"}],"ListaProcedure":[{"Nome":"AGGIORNA_DOCENTI_DISPONIBILITA","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n \r\n  IF (SELECT count(*) FROM docenti_disponibilita WHERE DOCENTE = DocenteDisp AND ISTITUTO = IstitutoDisp AND GIORNO = GiornoDisp AND POSIZIONE = PosDisp) > 0 THEN\r\n      UPDATE docenti_disponibilita SET DA = DaDisp,A = ADisp WHERE DOCENTE = DocenteDisp AND ISTITUTO = IstitutoDisp AND GIORNO = GiornoDisp AND POSIZIONE = PosDisp;\r\n  ELSE\r\n      INSERT INTO docenti_disponibilita (DOCENTE,ISTITUTO,GIORNO,DA,A,POSIZIONE) VALUES (DocenteDisp,IstitutoDisp,GiornoDisp,DaDisp,ADisp,PosDisp);\r\n  END IF;\r\n\r\nEND","Parametri":[{"Nome":"DocenteDisp","Mode":"IN","Type":"int(11)"},{"Nome":"IstitutoDisp","Mode":"IN","Type":"int(11)"},{"Nome":"GiornoDisp","Mode":"IN","Type":"tinyint(4)"},{"Nome":"DaDisp","Mode":"IN","Type":"time"},{"Nome":"ADisp","Mode":"IN","Type":"time"},{"Nome":"PosDisp","Mode":"IN","Type":"tinyint(4)"}]},{"Nome":"AGGIORNA_ISTITUTO","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n  DECLARE NewKey INT;\r\n  DECLARE KeyTipologia INT;\r\n  SELECT MAX(CHIAVE)\r\n    FROM tipologie_istituto \r\n\tWHERE UPPER(DESCRIZIONE) = DescrizioneTipologia \r\n\t INTO KeyTipologia;\r\n  \r\n  IF KeyTipologia IS NULL THEN\r\n   UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n   SELECT MAX(CHIAVE) FROM gen_key INTO KeyTipologia; \r\n   INSERT INTO tipologie_istituto (CHIAVE,DESCRIZIONE) VALUES (KeyTipologia,DescrizioneTipologia);\r\n  END IF;\r\n  \r\n  IF (SELECT count(*) FROM istituti WHERE CODICE = CodiceIstituto) > 0 THEN\r\n    UPDATE istituti SET NOME = NomeIstituto, INDIRIZZO = IndirizzoIstituto, PROVINCIA = ProvinciaIstituto, COMUNE = ComuneIstituto, CAP = CapIstituto, EMAIL = EmailIstituto, PEC = PecIstituto, SITO_WEB = SitoWebIstituto, SEDE = SedeIstituto WHERE CODICE = CodiceIstituto;\r\n  ELSE\r\n   UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n   SELECT MAX(CHIAVE) FROM gen_key INTO NewKey; \r\n   INSERT INTO istituti (CHIAVE,CODICE,NOME,INDIRIZZO,PROVINCIA,COMUNE,CAP,EMAIL,PEC,SITO_WEB,SEDE,TIPOLOGIA) VALUES (NewKey,CodiceIstituto,NomeIstituto,IndirizzoIstituto,ProvinciaIstituto,ComuneIstituto,CapIstituto,EmailIstituto,PecIstituto,SitoWebIstituto,SedeIstituto,KeyTipologia);\r\n  END IF;\r\nEND","Parametri":[{"Nome":"CodiceIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"NomeIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"IndirizzoIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"ProvinciaIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"ComuneIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"CapIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"EmailIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"PecIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"SitoWebIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"SedeIstituto","Mode":"IN","Type":"bit(1)"},{"Nome":"DescrizioneTipologia","Mode":"IN","Type":"varchar(255)"}]},{"Nome":"AGGIORNA_TITOLI_ADOZIONI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n  DECLARE NewKey INT;\r\n  DECLARE KeyMateria INT;\r\n  DECLARE KeyClasse INT;\r\n  DECLARE KeyAdozione INT;\r\n  DECLARE KeyIstituto INT;\r\n  SELECT MAX(CHIAVE)\r\n    FROM materie_insegnamento \r\n\tWHERE UPPER(DESCRIZIONE) = DescrizioneMateria \r\n\t INTO KeyMateria;\r\n  \r\n  IF KeyMateria IS NULL THEN\r\n     UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n     SELECT MAX(CHIAVE) FROM gen_key INTO KeyMateria; \r\n     INSERT INTO materie_insegnamento(CHIAVE,DESCRIZIONE) VALUES (KeyMateria,DescrizioneMateria);\r\n  END IF;\r\n  \r\n  IF (SELECT count(*) FROM titoli WHERE CODICE_ISBN = CodiceTitolo) > 0 THEN\r\n      UPDATE titoli \r\n\t\t   SET TITOLO = TitoloTitolo, SOTTOTITOLO = SottotitoloTitolo, AUTORI = AutoriTitolo, EDITORE = EditoreTitolo, VOLUME = VolumeTitolo, PREZZO = PrezzoTitolo\r\n\t\t WHERE CODICE_ISBN = CodiceTitolo;\r\n  ELSE\r\n      UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n      SELECT MAX(CHIAVE) FROM gen_key INTO NewKey; \r\n      INSERT INTO titoli (CHIAVE,CODICE_ISBN,TITOLO,SOTTOTITOLO,AUTORI,EDITORE,VOLUME,MATERIA,PREZZO) VALUES (NewKey,CodiceTitolo,TitoloTitolo,SottotitoloTitolo,AutoriTitolo,EditoreTitolo,VolumeTitolo,KeyMateria,PrezzoTitolo);\r\n  END IF;\r\n  \r\n  SELECT istituti.CHIAVE \r\n    FROM istituti \r\n\tWHERE istituti.CODICE = IstitutoTitolo  \r\n\t INTO KeyIstituto;\r\n\t \r\n  IF KeyIstituto IS NOT NULL THEN\r\n     INSERT IGNORE INTO istituti_x_titoli (TITOLO,ISTITUTO) VALUES ((SELECT titoli.CHIAVE FROM titoli WHERE CODICE_ISBN = CodiceTitolo),KeyIstituto); \r\n\r\n\t  SELECT MAX(CHIAVE)\r\n\t  FROM classi \r\n\t  WHERE UPPER(ANNO) = AnnoTitolo AND UPPER(SEZIONE) = SezioneTitolo AND ISTITUTO = KeyIstituto\r\n\t  INTO KeyClasse;\r\n\t  \r\n\t  IF KeyClasse IS NULL THEN\r\n\t     UPDATE gen_key \r\n\t\t  SET CHIAVE = CHIAVE + 1;\r\n\t     SELECT MAX(CHIAVE) FROM gen_key INTO KeyClasse; \r\n\t     INSERT INTO classi (CHIAVE,ANNO,SEZIONE,ISTITUTO) VALUES (KeyClasse,AnnoTitolo,SezioneTitolo,KeyIstituto);\r\n\t  END IF;\r\n\t  \r\n\t  SELECT MAX(CHIAVE)\r\n\t  FROM adozioni_titolo\r\n\t  WHERE TITOLO = (SELECT titoli.CHIAVE FROM titoli WHERE CODICE_ISBN = CodiceTitolo) AND CLASSE = KeyClasse\r\n\t  INTO KeyAdozione;\r\n\t  \r\n\t  IF KeyAdozione IS NULL THEN\r\n\t     UPDATE gen_key \r\n\t\t  SET CHIAVE = CHIAVE + 1;\r\n\t     SELECT MAX(CHIAVE) FROM gen_key INTO KeyAdozione; \r\n\t     INSERT INTO adozioni_titolo (CHIAVE,TITOLO,CLASSE) VALUES (KeyAdozione,(SELECT titoli.CHIAVE FROM titoli WHERE CODICE_ISBN = CodiceTitolo),KeyClasse);\r\n\t  END IF;\r\n\t  \r\n  END IF;\r\n  \r\nEND","Parametri":[{"Nome":"CodiceTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"TitoloTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"SottotitoloTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"AutoriTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"EditoreTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"VolumeTitolo","Mode":"IN","Type":"tinyint(4)"},{"Nome":"DescrizioneMateria","Mode":"IN","Type":"varchar(255)"},{"Nome":"IstitutoTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"AnnoTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"SezioneTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"PrezzoTitolo","Mode":"IN","Type":"varchar(255)"}]},{"Nome":"AGGIORNA_TITOLI_FROM_CATALOGHI_DEAGOSTINI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n\r\n  DECLARE NewKey INT;\r\n  \r\n  IF (SELECT count(*) FROM titoli WHERE CODICE_ISBN = CodiceTitolo) > 0 THEN\r\n      UPDATE titoli \r\n\t\t   SET TITOLO = TitoloTitolo, EDITORE = EditoreTitolo, PREZZO = PrezzoTitolo, VOLUME = VolumeTitolo \r\n\t\t WHERE CODICE_ISBN = CodiceTitolo;\r\n  ELSE\r\n      UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n      SELECT MAX(CHIAVE) FROM gen_key INTO NewKey; \r\n      INSERT INTO titoli (CHIAVE,CODICE_ISBN,TITOLO,SOTTOTITOLO,AUTORI,EDITORE,MATERIA,VOLUME,PREZZO) VALUES (NewKey,CodiceTitolo,TitoloTitolo,null,null,EditoreTitolo,null,VolumeTitolo,PrezzoTitolo);\r\n  END IF;\r\n\t  \r\nEND","Parametri":[{"Nome":"CodiceTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"TitoloTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"EditoreTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"VolumeTitolo","Mode":"IN","Type":"tinyint(4)"},{"Nome":"PrezzoTitolo","Mode":"IN","Type":"varchar(255)"}]},{"Nome":"AGGIORNA_TITOLI_FROM_CATALOGHI_MONDADORI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n  DECLARE NewKey INT;\r\n  DECLARE KeyMateria INT;\r\n\r\n  SELECT MAX(CHIAVE)\r\n    FROM materie_insegnamento \r\n\tWHERE UPPER(DESCRIZIONE) = DescrizioneMateria \r\n\t INTO KeyMateria;\r\n  \r\n  IF KeyMateria IS NULL THEN\r\n\t  UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n\t  SELECT MAX(CHIAVE) FROM gen_key INTO KeyMateria; \r\n     INSERT INTO materie_insegnamento(CHIAVE,DESCRIZIONE) VALUES (KeyMateria,DescrizioneMateria);\r\n  END IF;\r\n  \r\n  IF (SELECT count(*) FROM titoli WHERE CODICE_ISBN = CodiceTitolo) > 0 THEN\r\n      UPDATE titoli SET TITOLO = TitoloTitolo, AUTORI = AutoriTitolo, EDITORE = EditoreTitolo, PREZZO = PrezzoTitolo \r\n\t\t WHERE CODICE_ISBN = CodiceTitolo;\r\n  ELSE\r\n      UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n      SELECT MAX(CHIAVE) FROM gen_key INTO NewKey; \r\n      INSERT INTO titoli (CHIAVE,CODICE_ISBN,TITOLO,SOTTOTITOLO,AUTORI,EDITORE,MATERIA,VOLUME,PREZZO) VALUES (NewKey,CodiceTitolo,TitoloTitolo,SottotitoloTitolo,AutoriTitolo,EditoreTitolo,KeyMateria,VolumeTitolo,PrezzoTitolo);\r\n  END IF;\r\n\t  \r\nEND","Parametri":[{"Nome":"CodiceTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"TitoloTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"SottotitoloTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"DescrizioneMateria","Mode":"IN","Type":"varchar(255)"},{"Nome":"AutoriTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"EditoreTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"PrezzoTitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"VolumeTitolo","Mode":"IN","Type":"tinyint(4)"}]},{"Nome":"CALCOLA_DISPONIBILITA","Type":"FUNCTION","ReturnType":"int(11)","Body":"BEGIN\r\n\r\n  DECLARE QuantitaMagazzino INT;\r\n  DECLARE QuantitaDaSpedire INT;\r\n  \r\n  (SELECT titoli.QUANTITA_MGZN FROM titoli WHERE CHIAVE = ChiaveTitolo) INTO QuantitaMagazzino;\r\n  (SELECT SUM(QUANTITA) FROM dettaglio_spedizioni WHERE dettaglio_spedizioni.STATO = 'S' AND dettaglio_spedizioni.TITOLO = ChiaveTitolo) INTO QuantitaDaSpedire;\r\n  \r\n  IF QuantitaMagazzino - QuantitaDaSpedire > 0 THEN RETURN 1;\r\n  ELSE RETURN 0;\r\n  END IF; \r\n  \r\nEND","Parametri":[{"Nome":"ChiaveTitolo","Mode":"IN","Type":"int(11)"}]},{"Nome":"CALCOLA_DISPONIBILITA_ALL","Type":"FUNCTION","ReturnType":"int(11)","Body":"BEGIN\r\n\r\n  DECLARE QuantitaMagazzino INT;\r\n  DECLARE QuantitaDaSpedire INT;\r\n  DECLARE QuantitaFinale    INT;\r\n  \r\n  (SELECT titoli.QUANTITA_MGZN FROM titoli WHERE CHIAVE = ChiaveTitolo) INTO QuantitaMagazzino;\r\n  (SELECT SUM(QUANTITA) FROM dettaglio_spedizioni WHERE dettaglio_spedizioni.STATO = 'S' AND dettaglio_spedizioni.TITOLO = ChiaveTitolo) INTO QuantitaDaSpedire;\r\n  \r\n  IF QuantitaMagazzino - QuantitaDaSpedire > 0 THEN \r\n     SET QuantitaFinale = QuantitaMagazzino - QuantitaDaSpedire;\r\n     RETURN QuantitaFinale;\r\n  ELSE RETURN 0;\r\n  END IF; \r\n  \r\n\r\nEND","Parametri":[{"Nome":"ChiaveTitolo","Mode":"IN","Type":"int(11)"}]},{"Nome":"ERASE_ALL","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n DELETE FROM istituti_x_titoli;\r\n DELETE FROM istituti_x_docenti;\r\n DELETE FROM istituti;\r\n DELETE FROM insegnamenti_docente;\r\n DELETE FROM titoli;\r\n DELETE FROM docenti;\r\n DELETE FROM materie_insegnamento;\r\n DELETE FROM tipologie_istituto;\r\nEND","Parametri":[]},{"Nome":"LYBRO_AGGIORNA_ISTITUTI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n  DECLARE NewKey INT;\r\n      \r\n  IF (SELECT count(*) FROM istituti WHERE CODICE = CodiceIstituto) > 0 THEN\r\n      UPDATE istituti \r\n\t\t   SET NOME = NomeIstituto,INDIRIZZO = IndirizzoIstituto,PROVINCIA = ProvinciaIstituto,COMUNE = ComuneIstituto,CAP = CapIstituto,EMAIL = EmailIstituto,SITO_WEB = SitoWebIstituto,PRESIDE = PresideIstituto,VICEPRESIDE = VicePresIstituto,DIR_AMMNSTR = DirAmmIstituto,TELEFONO_1 = Telefono1,REFERENTE_1 = Referente1,TELEFONO_2 = Telefono2,REFERENTE_2 = Referente2,TELEFONO_3 = Telefono3,REFERENTE_3 = Referente3  WHERE CODICE = CodiceIstituto;\r\n  ELSE\r\n      UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n      SELECT MAX(CHIAVE) FROM gen_key INTO NewKey; \r\n      INSERT INTO istituti (CHIAVE,CODICE,NOME,INDIRIZZO,PROVINCIA,COMUNE,CAP,EMAIL,SITO_WEB,PRESIDE,VICEPRESIDE,DIR_AMMNSTR,TELEFONO_1,REFERENTE_1,TELEFONO_2,REFERENTE_2,TELEFONO_3,REFERENTE_3) VALUES (NewKey,CodiceIstituto,NomeIstituto,IndirizzoIstituto,ProvinciaIstituto,ComuneIstituto,CapIstituto,EmailIstituto,SitoWebIstituto,PresideIstituto,VicePresIstituto,DirAmmIstituto,Telefono1,Referente1,Telefono2,Referente2,Telefono3,Referente3); \r\n  END IF;\r\n  \r\n  INSERT IGNORE INTO istituti_x_docenti (DOCENTE,ISTITUTO) VALUES ((SELECT docenti.CHIAVE FROM docenti WHERE LYBRO_KEY = DocenteLybro),(SELECT istituti.CHIAVE FROM istituti WHERE istituti.CODICE = CodiceIstituto)); \r\n  \r\nEND","Parametri":[{"Nome":"CodiceIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"NomeIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"IndirizzoIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"ProvinciaIstituto","Mode":"IN","Type":"int(11)"},{"Nome":"ComuneIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"CapIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"EmailIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"SitoWebIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"PresideIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"VicePresIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"DirAmmIstituto","Mode":"IN","Type":"varchar(255)"},{"Nome":"Telefono1","Mode":"IN","Type":"varchar(255)"},{"Nome":"Referente1","Mode":"IN","Type":"varchar(255)"},{"Nome":"Telefono2","Mode":"IN","Type":"varchar(255)"},{"Nome":"Referente2","Mode":"IN","Type":"varchar(255)"},{"Nome":"Telefono3","Mode":"IN","Type":"varchar(255)"},{"Nome":"Referente3","Mode":"IN","Type":"varchar(255)"},{"Nome":"DocenteLybro","Mode":"IN","Type":"int(11)"}]},{"Nome":"MATERIE_FROM_LYBRO","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n  DECLARE KeyMateria INT;    \r\n  DECLARE MateriaUno INT;\r\n  DECLARE MateriaDue INT;\r\n  DECLARE MateriaTre INT;\r\n  \r\n  SELECT MAX(CHIAVE)\r\n    FROM materie_insegnamento \r\n\tWHERE UPPER(DESCRIZIONE) = MateriaLybro \r\n\t INTO KeyMateria;\r\n  \r\n  IF KeyMateria IS NULL THEN\r\n     UPDATE gen_key SET CHIAVE = CHIAVE + 1;\r\n     SELECT MAX(CHIAVE) FROM gen_key INTO KeyMateria; \r\n     INSERT INTO materie_insegnamento(CHIAVE,DESCRIZIONE) VALUES (KeyMateria,MateriaLybro);\r\n  END IF;\r\n  \r\n  SELECT docenti.MATERIA_1,docenti.MATERIA_2,docenti.MATERIA_3 INTO MateriaUno,MateriaDue,MateriaTre FROM docenti WHERE LYBRO_KEY = DocenteLKey;\r\n\r\n  IF MateriaUno IS NULL THEN\r\n     SET MateriaUno := 0;\r\n  END IF;\r\n\r\n  IF MateriaDue IS NULL THEN\r\n     SET MateriaDue := 0;\r\n  END IF;\r\n\r\n  IF MateriaTre IS NULL THEN\r\n     SET MateriaTre := 0;\r\n  END IF;\r\n\r\n  IF (KeyMateria <> MateriaUno AND KeyMateria <> MateriaDue AND KeyMateria <> MateriaTre) THEN \r\n      IF MateriaUno = 0 THEN UPDATE docenti SET MATERIA_1 = KeyMateria WHERE LYBRO_KEY = DocenteLKey;\r\n      ELSEIF MateriaDue = 0 THEN UPDATE docenti SET MATERIA_2 = KeyMateria WHERE LYBRO_KEY = DocenteLKey;\r\n      ELSE UPDATE docenti SET MATERIA_3 = KeyMateria WHERE LYBRO_KEY = DocenteLKey;\r\n      END IF;\r\n  END IF;\r\n\r\nEND","Parametri":[{"Nome":"MateriaLybro","Mode":"IN","Type":"varchar(255)"},{"Nome":"DocenteLKey","Mode":"IN","Type":"varchar(255)"}]},{"Nome":"UNISCI_NASCONDI_ISTITUTI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n\r\n  DELETE FROM docenti_disponibilita WHERE ISTITUTO = OldIstituto;\r\n  DELETE FROM insegnamenti_docente WHERE CLASSE IN (SELECT CHIAVE FROM classi WHERE ISTITUTO = OldIstituto);   \r\n  UPDATE IGNORE istituti_x_docenti SET ISTITUTO = NewIstituto WHERE ISTITUTO = OldIstituto;\r\n  DELETE FROM istituti_x_docenti WHERE ISTITUTO = OldIstituto;\r\n  UPDATE istituti SET NASCOSTO = 1 WHERE CHIAVE = OldIstituto;\r\n\r\nEND","Parametri":[{"Nome":"OldIstituto","Mode":"IN","Type":"int(11)"},{"Nome":"NewIstituto","Mode":"IN","Type":"int(11)"}]},{"Nome":"UPDATE_TITOLI_LOG_MAGAZZINI","Type":"PROCEDURE","ReturnType":null,"Body":"BEGIN\r\n \r\n  DECLARE OldQuantita INT;\r\n  DECLARE OldQuantitaVol INT;\r\n  \r\n  SELECT titoli.QUANTITA_MGZN,titoli.QUANTITA_MGZN_VOL \r\n    FROM titoli \r\n\tWHERE CHIAVE=ChiaveTitolo \r\n\t INTO OldQuantita,OldQuantitaVol;\r\n  \r\n  UPDATE titoli SET CODICE_ISBN=Codice,TITOLO=Titolo,SOTTOTITOLO=Sottotitolo,MATERIA=Materia,AUTORI=Autori,EDITORE=Editore,VOLUME=Volume,POS_MAGAZZINO=PosMgzn,PREZZO=Prezzo,QUANTITA_MGZN=QuantitaMgzn,QUANTITA_MGZN_VOL=QuantitaMgznVol \r\n   WHERE CHIAVE=ChiaveTitolo;\r\n  IF QuantitaMgzn <> 0 THEN\r\n    INSERT INTO movimenti_magazzino (TITOLO,QUANTITA,DESCRIZIONE) VALUES (ChiaveTitolo,QuantitaMgzn - OldQuantita,'Modificata quantita magazzino da titoli');\r\n  END IF;\r\n  IF QuantitaMgznVol <> 0 THEN\r\n    INSERT INTO movimenti_magazzino_volante (TITOLO,QUANTITA,DESCRIZIONE) VALUES (ChiaveTitolo,QuantitaMgznVol - OldQuantitaVol,'Modificata quantita magazzino volante da titoli');\r\n  END IF;\r\nEND","Parametri":[{"Nome":"ChiaveTitolo","Mode":"IN","Type":"int(11)"},{"Nome":"Codice","Mode":"IN","Type":"varchar(255)"},{"Nome":"Titolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"Sottotitolo","Mode":"IN","Type":"varchar(255)"},{"Nome":"Materia","Mode":"IN","Type":"int(11)"},{"Nome":"Autori","Mode":"IN","Type":"varchar(255)"},{"Nome":"Editore","Mode":"IN","Type":"varchar(255)"},{"Nome":"Volume","Mode":"IN","Type":"int(11)"},{"Nome":"Prezzo","Mode":"IN","Type":"varchar(255)"},{"Nome":"PosMgzn","Mode":"IN","Type":"varchar(255)"},{"Nome":"QuantitaMgzn","Mode":"IN","Type":"int(11)"},{"Nome":"QuantitaMgznVol","Mode":"IN","Type":"int(11)"}]}],"__CommentCampiDaEliminare":"Vettore di oggetti con Campo e Tabella","CampiDaEliminare":[],"__CommentTabelleDaEliminare":"Vettore di stringhe con i nomi delle tabelle","TabelleDaEliminare":[],"__CommentQueryAllCreazione":"Vettore di stringhe contenente la lista di query","QryOnDBaseCreation":["INSERT INTO `utenti` (`CHIAVE`, `USERNAME`, `RAGIONE_SOCIALE`, `PASSWORD`, `EMAIL`, `ROLE`, `ELIMINATO`) VALUES (1, 'admin', 'admin', '', '', 1, b'0')","INSERT INTO `configurazione_ditta` (`INDIRIZZO`, `EMAIL`, `SITO_WEB`, `TELEFONO`) VALUES ('', '', '', '')","INSERT INTO `province` (`CHIAVE`, `NOME`) VALUES (1, 'LA SPEZIA'), (2, 'SAVONA'),(3, 'GENOVA'),(4, 'ALESSANDRIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73818, 'AGRIGENTO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73819, 'ALESSANDRIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73820, 'ANCONA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73821, 'AOSTA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73822, 'L\\'AQUILA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73823, 'AREZZO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73824, 'ASCOLI-PICENO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73825, 'ASTI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73826, 'AVELLINO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73827, 'BARI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73828, 'BARLETTA-ANDRIA-TRANI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73829, 'BELLUNO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73830, 'BENEVENTO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73831, 'BERGAMO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73832, 'BIELLA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73833, 'BOLOGNA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73834, 'BOLZANO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73835, 'BRESCIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73836, 'BRINDISI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73837, 'CAGLIARI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73838, 'CALTANISSETTA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73839, 'CAMPOBASSO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73840, 'CARBONIA IGLESIAS')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73841, 'CASERTA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73842, 'CATANIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73843, 'CATANZARO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73844, 'CHIETI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73845, 'COMO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73846, 'COSENZA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73847, 'CREMONA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73848, 'CROTONE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73849, 'CUNEO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73850, 'ENNA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73851, 'FERMO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73852, 'FERRARA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73853, 'FIRENZE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73854, 'FOGGIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73855, 'FORLI-CESENA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73856, 'FROSINONE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73857, 'GENOVA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73858, 'GORIZIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73859, 'GROSSETO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73860, 'IMPERIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73861, 'ISERNIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73862, 'LA SPEZIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73863, 'LATINA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73864, 'LECCE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73865, 'LECCO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73866, 'LIVORNO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73867, 'LODI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73868, 'LUCCA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73869, 'MACERATA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73870, 'MANTOVA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73871, 'MASSA CARRARA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73872, 'MATERA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73873, 'MEDIO CAMPIDANO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73874, 'MESSINA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73875, 'MILANO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73876, 'MODENA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73877, 'MONZA-BRIANZA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73878, 'NAPOLI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73879, 'NOVARA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73880, 'NUORO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73881, 'OGLIASTRA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73882, 'OLBIA TEMPIO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73883, 'ORISTANO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73884, 'PADOVA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73885, 'PALERMO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73886, 'PARMA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73887, 'PAVIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73888, 'PERUGIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73889, 'PESARO-URBINO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73890, 'PESCARA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73891, 'PIACENZA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73892, 'PISA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73893, 'PISTOIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73894, 'PORDENONE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73895, 'POTENZA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73896, 'PRATO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73897, 'RAGUSA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73898, 'RAVENNA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73899, 'REGGIO-CALABRIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73900, 'REGGIO-EMILIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73901, 'RIETI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73902, 'RIMINI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73903, 'ROMA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73904, 'ROVIGO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73905, 'SALERNO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73906, 'SASSARI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73907, 'SAVONA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73908, 'SIENA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73909, 'SIRACUSA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73910, 'SONDRIO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73911, 'TARANTO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73912, 'TERAMO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73913, 'TERNI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73914, 'TORINO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73915, 'TRAPANI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73916, 'TRENTO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73917, 'TREVISO')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73918, 'TRIESTE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73919, 'UDINE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73920, 'VARESE')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73921, 'VENEZIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73922, 'VERBANIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73923, 'VERCELLI')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73924, 'VERONA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73925, 'VIBO-VALENTIA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73926, 'VICENZA')","INSERT INTO `province_all` (`CHIAVE`, `NOME`) VALUES (73927, 'VITERBO')"]}